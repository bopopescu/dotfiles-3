RewriteEngine on
RewriteBase /api

RewriteCond %{REQUEST_FILENAME} -s [OR]
RewriteCond %{REQUEST_FILENAME} -l [OR]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.*$ - [NC,L]

#RewriteRule ^.*$ index.php [NC,L]
RewriteRule !\.(js|ico|gif|jpg|jpeg|png|css|pdf|swf|flv|xml|php|html|zip|xls|doc|lzh)$ index.php [NC,L]

# 重要 session name を認証キーにしているため
php_value session.name "tempPass"

php_value memory_limit            2048M
php_value post_max_size           1024M
php_value upload_max_filesize     1024M
php_value zlib.output_compression On

### use gzip
<IfModule mod_deflate.c>
  # Web Browser
  SetOutputFilter DEFLATE
  BrowserMatch ^Mozilla/4 gzip-only-text/html
  BrowserMatch ^Mozilla/4\.0[678] no-gzip
  BrowserMatch \bMSI[E] !no-gzip !gzip-only-text/html
  SetEnvIfNoCase Request_URI .(?:gif|jpe?g|png|zip)$ no-gzip dont-vary
  # MIME Type
  # DeflateCompressionLevel 5
  AddOutputFilterByType DEFLATE text/plain
  AddOutputFilterByType DEFLATE text/html
  AddOutputFilterByType DEFLATE text/xml
  AddOutputFilterByType DEFLATE text/css
  AddOutputFilterByType DEFLATE application/xml
  AddOutputFilterByType DEFLATE application/xhtml+xml
  AddOutputFilterByType DEFLATE application/rss+xml
  AddOutputFilterByType DEFLATE application/javascript
  AddOutputFilterByType DEFLATE application/x-javascript
  AddOutputFilterByType DEFLATE application/x-httpd-php
  AddOutputFilterByType DEFLATE application/x-httpd-fastphp
  AddOutputFilterByType DEFLATE image/svg+xml
  # Proxy
  <IfModule mod_headers.c>
    Header append Vary User-Agent env=!dont-vary
    # Header append Cache-Control private
  </IfModule>
</IfModule>

### Use expires headers for images
<IfModule mod_expires.c>
  ExpiresActive  On
  ExpiresByType  image/gif           A604800
  ExpiresByType  image/jpg         A604800
  ExpiresByType  image/jpeg          A604800
  ExpiresByType  image/png           A604800
  ExpiresByType  application/x-javascript  A86400
  ExpiresByType  application/javascript    A86400
  ExpiresDefault               A604800
</IfModule>
